---
title: 缓存
tags: 
- 缓存
categories:
- 缓存
---

# 一、缓存类型

## 1、本地缓存

###1）、实现方式：

LRUMap(apache工具类)

Ehcache

### 2）、优点

内存缓存，没有远程交互开销

### 3）、缺点

容量较小，无法扩展

## 2、分布式缓存



## 3、多级缓存

# 二、淘汰策略

## 1、FIFO

淘汰最早的数据

## 2、LRU：least recently used

最近最少使用

## 3、LFU

淘汰最近使用频率最低的数据

# 三、缓存问题

## 1、缓存不一致

## 2、缓存更新

## 3、缓存击穿（缓存穿透）

缓存里面没有要找的数据，去数据库里面查找

## 4、缓存雪崩

| 缓存问题   | 产生原因        | 解决方案                |
| ------ | ----------- | ------------------- |
| 缓存更新方式 | 数据变更、缓存时效性  | 同步更新、失效更新、异步更新、定时更新 |
| 缓存不一致  | 同步更新失败、异步更新 | 增加重试、补偿任务、最终一致      |
| 缓存穿透   | 恶意攻击        | 空对象缓存、blomfilter过滤器 |
| 缓存击穿   | 热点key失效     | 互斥更新、随机退避、差异失效时间    |
| 缓存雪崩   | 缓存挂掉        | 快速失败熔断、主从模式、集群模式    |



# 四、Redis

## 1、数据类型

## 2、功能

### 1）、bitmap

	### 2）、hyperLogLog

### 3)、geospatial

### 4)、pub/sub

### 5)、pipeline

### 6）、事务

### 7）、lua脚本



## 3、数据持久化

### 1）、AOF

二进制

### 2)、RDB

文本记录

## 4、淘汰策略

# 面试题

## 1、Redis和Memcache有什么区别？该如何选用？

|      | Redis   | Memcache |
| ---- | ------- | -------- |
| 数据类型 | 五种数据类型  | 只有一种     |
| 持久化  | RDB,AOF | 不支持      |
| 主从支持 |         | 不支持主从结构  |
| 分片支持 |         | 不支持分片    |
|      |         |          |

## 2、你用过哪些Redis的数据结构？用在什么场景下？

首先要知道五种数据类型:string,list,set,zset,hash;

|        | 场景       |
| ------ | -------- |
| string | 分布式锁，计数器 |
| hash   | 对象       |
| list   | 链表       |
| set    | 集合，去重    |
| zset   | 排行榜      |

## 3、Redis有哪些持久化方式？区别是什么？

|      | RDB                   | AOF             |
| ---- | --------------------- | --------------- |
| 效率   | 全库保存，效率较低，二进制格式，读写速度快 | 文本保存命令，执行效率低，灵活 |
| 数据丢失 | 丢失数据多                 | 少量的丢失           |
|      |                       |                 |
|      |                       |                 |
|      |                       |                 |

# 4、Redis的过期机制是怎么样的？Redis有哪些淘汰策略？

## 5、如何保证Redis的高并发和高可用？

高可用：sentinel

高并发：

## 6、如何使用Redis实现延迟队列？（异步队列）

使用sortedset做延迟队列，使用时间戳

使用list作为队列，rpush入队，生成消息，lpop出队，消费消息

使用pub/sub，实现一对多的队列

## 7、如何使用Redis实现分布式锁？



## 8、为什么Redis能这么快？（10w+ QPS）

1)、纯内存的数据库

**2）、单进程单线程，避免线程切换开销**

3）、数据类型简单

4）、使用多路IO服用模型，非阻塞IO